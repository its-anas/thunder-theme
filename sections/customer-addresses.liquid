{{ 'customer.css' | asset_url | stylesheet_tag }}
<script src="{{ 'customer.js' | asset_url }}" defer></script>

{%- style -%}
  .customer.{{ section.id }} {
    padding-top: {{ section.settings.top_space | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.bottom_space | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .customer.{{ section.id }} {
      padding-top: {{ section.settings.top_space }}px;
      padding-bottom: {{ section.settings.bottom_space }}px;
    }
  }
{%- endstyle -%}

<div class="customer">
  <div class="customer__container" style="gap: 6rem;">
    <div class="page-tabs">
      <a href="{{ routes.account_url }}" class="page-tab">Orders</a>
      <a href="{{ routes.account_addresses_url }}" class="page-tab selected">Addresses</a>
      <a href="{{ routes.account_logout_url }}" class="page-tab">Logout</a>
    </div>

    <h1>Addresses</h1>

    <customer-popup>
      <div class="buttons">
        <button
          id="customer__popup__add-address__button"
          class="button button--primary border"
          type="button"
        >
          Add a new address
        </button>
      </div>

      <div class="customer__popup hidden" id="customer__popup__add-address__form">
        <div class="customer__popup__container">
          <div class="customer__popup-icon" id="customer__popup__add-address__close-icon">
            {% render 'snippet-icons', icon: 'close' %}
          </div>
          {%- form 'customer_address', customer.new_address, class: 'customer__form' -%}
            <span>Please fill in the fields below:</span>
            <input
              type="text"
              name="address[first_name]"
              class="customer__form__input"
              value="{{ form.first_name }}"
              autocomplete="given-name"
              placeholder="First name"
              required
            >

            <input
              type="text"
              name="address[last_name]"
              class="customer__form__input"
              value="{{ form.last_name }}"
              autocomplete="family-name"
              placeholder="Last name"
              required
            >

            <input
              type="text"
              name="address[zip]"
              class="customer__form__input"
              value="{{ form.company }}"
              autocomplete="organization"
              placeholder="Company"
            >

            <input
              type="text"
              name="address[address1]"
              class="customer__form__input"
              value="{{ form.address1 }}"
              autocomplete="address-line1"
              placeholder="Address 1"
              required
            >

            <input
              type="text"
              name="address[address2]"
              class="customer__form__input"
              value="{{ form.address2 }}"
              autocomplete="address-line2"
              placeholder="Address 2"
            >

            <input
              type="text"
              name="address[city]"
              class="customer__form__input"
              value="{{ form.city }}"
              autocomplete="address-level2"
              placeholder="City"
              required
            >

            <select
              type="select"
              name="address[country]"
              class="customer__form__input"
              data-address-country-select
              data-default="{{ form.country }}"
              autocomplete="country"
              required
            >
              {{ all_country_option_tags }}
            </select>

            <select
              type="select"
              name="address[province]"
              class="customer__form__input"
              data-address-province-select
              data-default="{{ form.province }}"
              autocomplete="address-level1"
              Pl
            ></select>

            <input
              type="text"
              name="address[zip]"
              class="customer__form__input"
              value="{{ form.zip }}"
              autocapitalize="characters"
              autocomplete="postal-code"
              placeholder="Postal/ZIP code"
              required
            >

            <input
              type="tel"
              name="address[phone]"
              class="customer__form__input"
              value="{{ form.phone }}"
              autocomplete="tel"
              placeholder="Phone"
            >

            <div>
              {{ form.set_as_default_checkbox }}
              <label for="address_default_address_new">Set as default address</label>
            </div>
            <div class="buttons">
              <button class="button button--primary border" id="customer__popup__add-address__add-button" type="submit">
                Add address
              </button>
              <button
                class="button button--secondary border"
                id="customer__popup__add-address__cancel-button"
                type="reset"
              >
                Cancel
              </button>
            </div>
          {%- endform -%}
        </div>
      </div>
    </customer-popup>
    {%- paginate customer.addresses by 4 -%}
      <div class="customer-addresses__addresses-list">
        <!-- ANCHOR: Address -->
        {%- for address in customer.addresses -%}
          <div class="customer-addresses__address">
            <div class="customer-addresses__address__container">
              {%- if address == customer.default_address -%}
                <h6>Default address</h6>
              {% else %}
                <h6>Address {{ forloop.index | plus: paginate.current_offset }}</h6>
              {%- endif -%}

              <span>{{ address | format_address }}</span>
              <customer-popup>
                <div class="customer-addresses__buttons">
                  <button
                    type="button"
                    class="button--link"
                    id="customer__popup__add-address__button"
                  >
                    Edit
                  </button>

                  <form
                    method="post"
                    action="/account/addresses/{{ address.id }}"
                    onsubmit="return confirm('Are you sure you wish to delete this address?');"
                  >
                    <input type="hidden" name="_method" value="delete">
                    <button
                      type="submit"
                      class="button--link"
                    >
                      Delete
                    </button>
                  </form>
                </div>

                <div class="customer__popup hidden" id="customer__popup__add-address__form">
                  <div class="customer__popup__container">
                    <div class="customer__popup-icon" id="customer__popup__add-address__close-icon">
                      {% render 'snippet-icons', icon: 'close' %}
                    </div>
                    {%- form 'customer_address', address, class: 'customer__form' -%}
                      <div class="customer__form__content">
                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[first_name]"
                          value="{{ form.first_name }}"
                          autocomplete="given-name"
                          placeholder="First name"
                        >

                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[last_name]"
                          value="{{ form.last_name }}"
                          autocomplete="family-name"
                          placeholder="Last name"
                        >

                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[company]"
                          value="{{ form.company }}"
                          autocomplete="organization"
                          placeholder="Company"
                        >

                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[address1]"
                          value="{{ form.address1 }}"
                          autocomplete="address-line1"
                          placeholder="Address 1"
                        >

                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[address2]"
                          value="{{ form.address2 }}"
                          autocomplete="address-line2"
                          placeholder="Address 2"
                        >

                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[city]"
                          value="{{ form.city }}"
                          autocomplete="address-level2"
                          placeholder="City"
                        >

                        <select
                          class="customer__form__input"
                          name="address[country]"
                          data-address-country-select
                          data-default="{{ form.country }}"
                          autocomplete="country"
                        >
                          {{ all_country_option_tags }}
                        </select>

                        <select
                          class="customer__form__input"
                          name="address[province]"
                          data-address-province-select
                          data-default="{{ form.province }}"
                          autocomplete="address-level1"
                        ></select>

                        <input
                          class="customer__form__input"
                          type="text"
                          name="address[zip]"
                          value="{{ form.zip }}"
                          autocapitalize="characters"
                          autocomplete="postal-code"
                          placeholder="Postal/ZIP code"
                        >

                        <input
                          class="customer__form__input"
                          type="tel"
                          name="address[phone]"
                          value="{{ form.phone }}"
                          autocomplete="tel"
                          placeholder="Phone"
                        >
                      </div>
                      <div class="">
                        {{ form.set_as_default_checkbox }}
                        <span>Set as default address</span>
                      </div>

                      <div class="buttons">
                        <button
                          class="button button--primary border"
                        >
                          Update address
                        </button>
                        <button
                          class="button button--secondary border"
                          type="reset"
                          id="customer__popup__add-address__cancel-button"
                        >
                          Cancel
                        </button>
                      </div>
                    {%- endform -%}
                  </div>
                </div>
              </customer-popup>
            </div>
          </div>
        {%- endfor -%}

        {% render 'snippet-pagination', paginate: paginate %}
      </div>
    {%- endpaginate -%}
  </div>
</div>
{% schema %}
{
  "name": "Customer addresses",
  "settings": [
    {
      "type": "range",
      "id": "top_space",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Top space",
      "default": 0
    },
    {
      "type": "range",
      "id": "bottom_space",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom space",
      "default": 0
    }
  ]
}
{% endschema %}
